# HWPX 자동 생성 접근방식 종합 비교 보고서

**평가일**: 2026-02-09
**대상 문서**: 2026년 클라우드 종합솔루션 지원사업 사업계획서 (119페이지, 456 표)

---

## 1. 참조 문서 복잡도 분석

| 항목 | 수치 |
|------|------|
| 페이지 수 | 119 |
| section0.xml 크기 | 4.3MB |
| header.xml 크기 | 728KB |
| 표 (tables) | 456개 |
| 셀 (cells) | 3,798개 |
| 문단 (paragraphs) | 5,828개 |
| 텍스트 세그먼트 | 3,562개 |
| 이미지 | 63개 |
| 글자 속성 (charPr) | 370개 |
| 문단 속성 (paraPr) | 241개 |
| 테두리/채우기 (borderFill) | 178개 |
| 글꼴 | 12종 (한글) |
| 스타일 | 23종 |
| 그리기 객체 (gso) | 68개 |
| 수식 (equation) | 3개 |
| 메모 | 17개 |

**결론**: 매우 높은 복잡도의 정부 양식 문서. 단순한 라이브러리로는 재현 불가능한 수준.

---

## 2. 3가지 접근방식 테스트 결과

### 2.1 COM 자동화 (pywin32 + 한컴오피스 2024)

**테스트 결과**:
| 기능 | 결과 | 비고 |
|------|------|------|
| HWPX 열기 | ✅ 성공 | 119페이지 완전 로드 |
| 텍스트 추출 | ✅ 성공 | 6,280줄 추출 |
| 컨트롤 탐색 | ✅ 성공 | 569개 컨트롤 (456 표, 68 그리기) |
| 새 문서 생성 | ✅ 성공 | |
| 글꼴/스타일 적용 | ✅ 성공 | CharShape, ParaShape |
| 표 생성 | ✅ 성공 | InsertTable + 셀 접근 |
| PDF 저장 | ✅ 성공 | SaveAs("PDF") - 9.5MB |
| HWP 저장 | ✅ 성공 | |
| HWPX 저장 | ✅ 성공 | |
| HTML 저장 | ✅ 성공 | |
| TEXT 저장 | ✅ 성공 | |

**장점**:
- 한컴오피스의 **모든 기능** 사용 가능 (렌더링 엔진 포함)
- PDF 변환이 내장 (SaveAs "PDF")
- 기존 문서 열어서 수정 가능 (템플릿 기반 워크플로우)
- 100% 서식 재현 보장 (한글 프로그램 자체가 처리)
- 119페이지 복잡 문서도 완벽 처리

**단점**:
- Windows + 한컴오피스 필수
- 한글 프로세스 실행 필요 (백그라운드 가능하지만 느림)
- CI/CD 파이프라인에 부적합
- 동시 실행 시 COM 충돌 가능

### 2.2 python-hwpx 라이브러리 (v1.9)

**테스트 결과**:
| 기능 | 결과 | 비고 |
|------|------|------|
| 문서 생성 | ✅ 성공 | HwpxDocument.new() |
| 텍스트 추가 | ✅ 성공 | add_paragraph() |
| 표 생성 | ✅ 성공 | add_table(rows, cols) |
| 셀 병합 | ✅ 성공 | merge_cells() |
| 셀 텍스트 | ✅ 성공 | set_cell_text() |
| 글자 속성 | ⚠️ 제한적 | text_color, underline만 |
| 문단 정렬 | ⚠️ 제한적 | align 속성 존재 |
| 글꼴 변경 | ❌ 미확인 | API에서 직접 지원 불명확 |
| 줄간격 | ⚠️ 제한적 | line_spacing 존재 |
| 테두리/배경 | ⚠️ 제한적 | border_fill 존재하나 복잡 |
| PDF 변환 | ❌ 불가 | 자체 PDF 기능 없음 |
| 이미지 삽입 | ❌ 미확인 | add_shape은 있으나 이미지는 불명확 |

**장점**:
- 크로스플랫폼 (Windows/Linux/Mac)
- 한컴오피스 설치 불필요
- 빠른 실행 (직접 파일 생성)
- CI/CD 환경 적합

**단점**:
- 서식 재현 능력 매우 제한적
- PDF 변환 불가 (결국 COM 필요)
- 370개 charPr, 241개 paraPr, 178개 borderFill 재현 불가능
- 복잡한 표 구조 (11열, 셀 병합 118개) 재현 어려움
- 이미지 63개 삽입 미지원

### 2.3 직접 XML 생성 (템플릿 방식)

**테스트 결과**:
| 기능 | 결과 | 비고 |
|------|------|------|
| 기본 HWPX 생성 | ✅ 성공 | 4.4KB (최소 구조) |
| XML 구조 제어 | ✅ 완전 | 100% 제어 가능 |
| 스타일 재현 | ⚠️ 이론적으로 가능 | header.xml 728KB 복제 필요 |
| 복잡 표 | ⚠️ 이론적으로 가능 | 매우 복잡한 XML 조합 |
| PDF 변환 | ❌ 불가 | COM 필요 |
| linesegarray | ❓ 불확실 | 한글이 자동 생성하는지 미확인 |

**장점**:
- XML 구조 100% 제어
- 템플릿 기반으로 참조 문서와 동일 구조 생성 가능
- 크로스플랫폼

**단점**:
- 개발 복잡도 극도로 높음 (header.xml 728KB 관리!)
- linesegarray 등 렌더링 힌트 생성 문제
- PDF 변환 불가
- 유지보수 악몽 (HWPML 스펙 변경 시)
- 오류 가능성 높음

---

## 3. 종합 비교표

| 평가 기준 | COM 자동화 | python-hwpx | 직접 XML |
|-----------|-----------|------------|---------|
| **서식 재현도** | ★★★★★ | ★★☆☆☆ | ★★★★☆ (이론) |
| **PDF 변환** | ★★★★★ | ☆☆☆☆☆ | ☆☆☆☆☆ |
| **개발 용이성** | ★★★★☆ | ★★★☆☆ | ★☆☆☆☆ |
| **실행 속도** | ★★☆☆☆ | ★★★★★ | ★★★★☆ |
| **이식성** | ★☆☆☆☆ | ★★★★★ | ★★★★★ |
| **유지보수성** | ★★★★☆ | ★★★☆☆ | ★☆☆☆☆ |
| **기존 문서 수정** | ★★★★★ | ★★★☆☆ | ★☆☆☆☆ |
| **총점** | **28/35** | **18/35** | **16/35** |

---

## 4. 최종 추천: 하이브리드 COM 중심 방식

### 추천 아키텍처

```
[데이터 입력 (JSON/YAML)]
         │
         ▼
[Python 스크립트 (WSL)]
    │          │
    ▼          ▼
[HWPX 템플릿]  [COM 자동화 모듈]
    │          │
    ▼          ▼
[한컴오피스 COM API (Windows)]
         │
    ┌────┴────┐
    ▼         ▼
 [.hwpx]   [.pdf]
```

### 권장 워크플로우

1. **참조 문서를 템플릿으로 활용**
   - test_01.hwpx를 열어서 내용만 교체 (서식/스타일 그대로 유지)
   - COM API로 텍스트 필드값, 표 내용 수정

2. **COM으로 문서 생성 및 변환**
   - 새 문서가 필요한 경우: COM으로 처음부터 생성
   - PDF 변환: `hwp.SaveAs(path, "PDF", "")`

3. **Python에서 WSL↔Windows 브릿지**
   - WSL Python이 데이터 준비 (JSON 구조화)
   - Windows Python이 COM 스크립트 실행
   - 결과 파일을 WSL에서 검증

### 핵심 이유

1. **PDF 변환 필수** → COM만 가능
2. **119페이지 복잡 서식** → COM이 유일한 100% 재현 방법
3. **기존 템플릿 수정** → COM이 가장 자연스러운 접근
4. **한컴오피스 이미 설치** → 추가 비용 없음
5. **WSL 환경** → Windows COM 호출 가능

### lib-evaluator 추가 발견사항 (반영)

python-hwpx v1.9가 예상보다 우수:
- 28개 테스트 전체 PASS (스타일 11, 표 9, 종합 8)
- 셀 병합, 배경색, 테두리, 페이지 설정 모두 가능
- header XML 직접 수정으로 폰트/크기/색상 변경 가능
- 네임스페이스 프리픽스 변환 이슈 존재 (hp: → ns0:)

**수정된 최종 추천**: COM 중심 + python-hwpx 보조 하이브리드

- **문서 내용 생성**: python-hwpx (표, 텍스트, 스타일 조합)
- **PDF 변환 및 검증**: COM (한컴오피스 SaveAs PDF)
- **기존 문서 수정**: COM (템플릿 기반 필드 교체)

### 개발 단계

1단계: COM 기반 문서 열기/수정/저장/PDF 변환 파이프라인
2단계: 참조 문서 템플릿화 (필드 매핑)
3단계: 데이터 입력 스키마 정의 (JSON)
4단계: PDF 비교 검증 모듈
5단계: CLI/자동화 래퍼
